package com.theguaz{	import flash.display.*;	import flash.events.*;	import flash.net.*;	import flash.filesystem.*;	import flash.utils.ByteArray;	import flash.utils.getTimer;	import flash.geom.*;	import com.greensock.*;	import com.greensock.easing.*;	import com.bit101.components.PushButton;	import com.bit101.components.RadioButton;	import com.adobe.images.PNGEncoder;	import com.adobe.serialization.json.JSON;	public class PhotoB extends MovieClip {		private var _PhotoProfileBitmap:Bitmap;		private var _PhotoProfileBitmapData:BitmapData;		private var _photo:URLRequest;		private var _datos;		private var _ref;		private var _pushSave:PushButton;		private var _loading;		private var _callback:Function;		private var FinalBitmap:BitmapData;		private var atras;		public function PhotoB() {			addEventListener(Event.ADDED_TO_STAGE,configUI);					}		private function configUI(e:Event):void {			removeEventListener(Event.ADDED_TO_STAGE,configUI);			this.x = -1500;			this.y = -1500;			this.scaleY = this.scaleX = 1;			_ref = this;		}		////////////////////////////////////////////////////////////////////;		// RECIBO DATOS BITMAPDATA PROFILE, RUTA PHOTO LOW RESOLUTION, RUTA JSON.DATA, MOVIECLIP CARGANDO		public function fProfile(e,foto, dat, cargador):void {			_loading = cargador;			_photo = foto;			_datos = dat;			_PhotoProfileBitmapData = Bitmap(LoaderInfo(e.target).content).bitmapData;			_PhotoProfileBitmap = new Bitmap(_PhotoProfileBitmapData);			/// Profile			username_txt.text = _datos.from.username;			_PhotoProfileBitmap.width = _PhotoProfileBitmap.height = 81;			_PhotoProfileBitmap.x = 45;			_PhotoProfileBitmap.y = 718.15			addChild(_PhotoProfileBitmap);			// Description;			descripcion_txt.text = _datos.text;			// Cargo Photo			fCargaPhoto();		}		///////////////////////////////////////////////////		/////////////////////////////////////////////////// CARGO PHOTO		private function fCargaPhoto() {			this.x = -1500;			this.y = -1500;			this.scaleY = this.scaleX = 1;			trace("Load image instagram");			var loader:Loader = new Loader();			loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);			loader.load(_photo);		}		///////////////////////////////////////////////////		/////////////////////////////////////////////////// INSERTO IMAGEN AL CONTENEDOR		private function onComplete(e:Event):void {						trace("add Contenent and Photo");			atras = _ref.parent;			atras.removeChild(_loading);			black_mc.alpha = 0; black_mc.visible = false;			var PhotoBitmapData = Bitmap(LoaderInfo(e.target).content).bitmapData;			var PhotoBitmap:Bitmap = new Bitmap(PhotoBitmapData);			vacio_mc.addChild(PhotoBitmap);			vacio_mc.width = vacio_mc.height = 509.8			fGuardar();		}		////////////////////////////////////////////////////////////////////;		// INICIO GUARDADO DE IMAGEN CON CALLBACK PARA EL MAIN		public function fGuardar() {			var m:Matrix;			FinalBitmap = new BitmapData(_ref.width,_ref.height,false,0xffffff);			//m = this.transform.matrix;			FinalBitmap.draw(_ref);			_callback(FinalBitmap);					}				public function set callback(v:Function):void {			_callback = v;		}		public function get callback():Function {			return _callback;		}		///////// END OF CLASS	}}